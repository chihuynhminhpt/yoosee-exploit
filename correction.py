from collections import defaultdict

files = []

for i in range(1, 6):
    files.append(list(open('./firmware{}.bin'.format(i), 'rb').read()))

res = []
bestCnt = defaultdict(int)

for i in range(len(files[0])):
    votes = defaultdict(int)
    best = files[0][i]
    cnt = 0
    
    for j in range(len(files)):
        votes[files[j][i]] += 1

        if votes[files[j][i]] > cnt:
            best = files[j][i]
            cnt = votes[files[j][i]]

    res.append(best)
    bestCnt[cnt] += 1

    if i % 10000 == 0:
        print(i)

print(bestCnt)
open('firmwareCorrected.bin', 'wb').write(bytes(res))
